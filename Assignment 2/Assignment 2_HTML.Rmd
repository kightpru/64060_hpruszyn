---
title: "Assignment 2"
author: "Kight Pruszynski"
date: "2025-09-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```
Load Packages
```{r}
## The purpose of this assignment is to demonstrate the student's ability to use k-NN for classification. The task is to design a smarter marketing campaign for Universal Bank, a young, growing bank that aims to target customers who are most likely to accept a loan offer. 

## UniversalBank.csv contains data for 5,000 customers, including demographics, product utilization, and response to the last personal loan campaign (9.6% positive). 

## We will use the following packages.

library(dplyr)
library(class)
library(caret)
library(ISLR)
```

```{r}
## Create a dataset excluding ID and ZIP (Age, Experience, Income, Family, CCAvg, Education, Mortgage, PersonalLoan, SecuritiesAccount, CDAccount, Online,CreditCard)
## I couldn't remember exactly how to remove two columns and had to try several ways. 

universal <- read.csv("UniversalBank.csv")
m_universal <- universal[,-c(1, 5)]
summary(m_universal)

```

## Create Dummy Model

```{r}
## Transform categorical predictors with more than two categories into dummy variables.
## (Note: I've determined that Education has more than two categories.) 
## (Note: I also believed that Family had four categories, but the tutors say it refers to family size. It seems unlikely to me that all 5,000 observations have exactly 1, 2, 3, or 4 family members in their households, so I could make the case that it would be appropriate to assume 1, 2, 3, 4 are categories, each based on a range of number of family members.) 

m_universal$Education <- as.factor(m_universal$Education)
levels(m_universal$Education)
dummy_model <- dummyVars(~Education, data=m_universal)
dummy_model <- predict(dummy_model, m_universal)

m_universal <- cbind(m_universal%>%select(-Education),dummy_model)

```

## Normalize the Data

```{r}
## Normalize the data with a model.
## (Note: I needed significant help from the tutors, especially to remember piping.)

# Use the caret package to normalize everything except the target variable (Personal Loan)
norm_model <- preProcess(m_universal %>% select(-Personal.Loan), method = c("center", "scale"))
  norm_final <- predict(norm_model, m_universal %>% select(-Personal.Loan))

  summary(norm_final)
```

## Partition the Data -- Needs revision

```{r}
## Partition the data into training (60%) and validation (40%) sets. 
## (Note: I don't fully understand why we would partition training and validation data but not testing.)
## I have a problem -- I normalized the data set before partitioning and now I'm not sure how to get the original Personal Loan. 

set.seed(123)
train_index <- createDataPartition(norm_final$Age,p=0.6, list=FALSE) ## 60% reserved for training
train_data <- norm_final[train_index,]
t_valid_data <- norm_final[-train_index,] ## to use for validation (maybe I should use %<%)
valid_data <- createDataPartition(t_valid_data$Age,p=0.4, list=FALSE) ## 40% reserved for validation


summary(train_data)
summary(valid_data)
```

## Classify the Customer -- In Progress

```{r}
## Assignment 2, Part 1: Classify the customer specifying the success class as 1 (loan acceptance) and use the default cutoff value of 0.5 
## How would this customer be classified?

library(FNN)
library(class)



```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
